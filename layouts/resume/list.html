{{- define "main" }}

<header class="page-header">
  {{- partial "breadcrumbs.html" . }}
  <h1>
    {{ .Title }}
  </h1>
  {{- if .Description }}
  <div class="post-description">
    {{ .Description | markdownify }}
  </div>
  {{- end }}
</header>

{{- if .Content }}
<div class="post-content">
  {{- if not (.Param "disableAnchoredHeadings") }}
  {{- partial "anchored_headings.html" .Content -}}
  {{- else }}{{ .Content }}{{ end }}
</div>
{{- end }}

<!-- Resume Timeline -->
<div class="resume-timeline">
  {{- $resumeEntries := slice }}
  {{- range (where .Site.RegularPages "Section" "resume") }}
    {{- if ne .Kind "section" }}
      {{- $resumeEntries = $resumeEntries | append . }}
    {{- end }}
  {{- end }}
  
  {{- if gt (len $resumeEntries) 0 }}
  <div class="timeline-container">
    <div class="timeline-line"></div>
    
    {{- $index := 0 }}
    {{- range sort $resumeEntries "Date" "desc" }}
    {{- $isLeft := (mod $index 2) }}
    <div class="timeline-item {{ if eq $isLeft 0 }}timeline-left{{ else }}timeline-right{{ end }}">
      <div class="timeline-marker">
        <div class="timeline-dot"></div>
      </div>
      
      <div class="timeline-content">
        <div class="timeline-card">
          <div class="timeline-header">
            <h3 class="timeline-title">{{ .Title }}</h3>
            <div class="timeline-organization">{{ .Params.organization }}</div>
            {{- if .Params.location }}
            <div class="timeline-location">{{ .Params.location }}</div>
            {{- end }}
          </div>
          
          <div class="timeline-date">
            {{ .Date.Format "Jan 2006" }}
            {{- if .Params.endDate }}
              {{- $endDate := time .Params.endDate }}
              - {{ $endDate.Format "Jan 2006" }}
            {{- else }}
              - Present
            {{- end }}
          </div>
          
          {{- if .Params.description }}
          <div class="timeline-description">
            {{ .Params.description | markdownify }}
          </div>
          {{- end }}
          
          {{- if .Content }}
          <div class="timeline-details">
            {{ .Content }}
          </div>
          {{- end }}
          
          {{- with .Params.tags }}
          <div class="timeline-tags">
            {{- range . }}
            <span class="timeline-tag">{{ . }}</span>
            {{- end }}
          </div>
          {{- end }}
        </div>
      </div>
    </div>
    {{- $index = add $index 1 }}
    {{- end }}
  </div>
  {{- else }}
  <div class="no-resume-entries">
    <p>No resume entries found. Add some entries to the <code>/content/resume/</code> directory.</p>
  </div>
  {{- end }}
</div>

{{- end }}
